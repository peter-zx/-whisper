<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Whisper字幕工坊（简体中文）</title>
    <!-- 引入拆分的CSS文件 -->
    <link rel="stylesheet" href="/css/base.css">
    <link rel="stylesheet" href="/css/left-section.css">
    <link rel="stylesheet" href="/css/right-section.css">
    <link rel="stylesheet" href="/css/ad-modal.css">
    <link rel="stylesheet" href="/css/responsive.css">
</head>
<body>
    <!-- 核心布局容器 -->
    <div class="layout-container">
        <!-- 左栏：功能区（不变） -->
        <div class="left-section">
            <!-- 功能操作卡片 -->
            <div class="card">
                <h3 class="card-title">字幕转录功能</h3>
                <!-- 上传区域 -->
                <div class="upload-area" id="uploadArea">
                    <input type="file" id="fileInput" class="upload-input" accept=".mp3,.wav,.flac,.m4a,.mp4,.avi,.mov">
                    <div class="upload-text">点击或拖拽文件到此处上传</div>
                    <div id="fileName" class="file-name"></div>
                </div>

                <!-- 模型选择 -->
                <div class="form-group">
                    <label class="form-label">选择模型：</label>
                    <select id="modelSelect" class="form-control">
                        <option value="tiny" selected>Tiny（~100MB | CPU | 最快/精度一般）</option>
                        <option value="base">Base（~1GB | CPU | 平衡/精度较好）</option>
                        <option value="small">Small（~1.5GB | 可选GPU | 中等/精度好）</option>
                        <option value="medium">Medium（~3GB | 建议GPU | 高精度）</option>
                        <option value="large">Large（~6GB | 必须GPU | 最高精度）</option>
                    </select>
                </div>

                <!-- 语言选择 -->
                <div class="form-group">
                    <label class="form-label">选择语言：</label>
                    <select id="languageSelect" class="form-control">
                        <option value="zh" selected>简体中文</option>
                        <option value="en">英文</option>
                        <option value="ja">日语</option>
                        <option value="ko">韩语</option>
                    </select>
                </div>

                <!-- 任务类型 -->
                <div class="form-group">
                    <label class="form-label">任务类型：</label>
                    <select id="taskSelect" class="form-control">
                        <option value="transcribe" selected>转录（保留简体中文）</option>
                        <option value="translate">翻译（转为英文）</option>
                    </select>
                </div>

                <!-- GPU/CPU选项 -->
                <div class="form-group">
                    <label class="form-label">运行设备：</label>
                    <select id="deviceSelect" class="form-control">
                        <option value="cpu" selected>CPU（兼容性好 | 所有模型支持）</option>
                        <option value="gpu">GPU（速度更快 | 需N卡+CUDA）</option>
                    </select>
                </div>

                <!-- 开始按钮 -->
                <button id="startBtn" class="btn-primary">开始转录</button>

                <!-- 进度条 -->
                <div class="progress-container" id="progressContainer">
                    <div class="progress-bar" id="progressBar"></div>
                </div>
                <div class="progress-text" id="progressText">0% 准备中...</div>
            </div>

            <!-- 宣传卡片 -->
            <div class="card">
                <h3 class="card-title">AIGC散修·竹相</h3>
                <div class="promote-content">
                    <p class="tech-desc">只分享验证可行的前沿技术（因为热爱所以发电）</p>
                    <img src="/assets/qrcode.png" alt="公众号二维码" class="qrcode-img" onerror="this.src='https://via.placeholder.com/100'; this.alt='二维码占位图';">
                    <p class="public-name">公众号：AIGC散修_竹相</p>
                </div>
            </div>
        </div>

        <!-- 右栏：预览区（核心修改） -->
        <div class="right-section">
            <!-- 合并：下载按钮 + 转录历史 卡片 -->
            <div class="card download-history-card">
                <h3 class="card-title">字幕下载 & 转录历史</h3>
                
                <!-- 下载按钮区域 -->
                <div class="download-buttons">
                    <button class="btn-download" data-format="srt">SRT格式</button>
                    <button class="btn-download" data-format="txt">TXT格式</button>
                    <button class="btn-download" data-format="vtt">VTT格式</button>
                    <button class="btn-download" data-format="json">JSON格式</button>
                </div>

                <!-- 转录历史网格 -->
                <div class="history-grid-container">
                    <p class="history-title">最近转录（最多10条）</p>
                    <div id="historyGrid" class="history-grid"></div>
                </div>
            </div>

            <!-- 结果预览卡片（放大三倍高度） -->
            <div class="card preview-card">
                <h3 class="card-title">转录结果预览（简体中文）</h3>
                <div id="resultPreview" class="preview-content"></div>
            </div>
        </div>
    </div>

    <!-- 广告弹窗 -->
    <div class="ad-overlay" id="adOverlay">
        <div class="ad-modal" id="adModal">
            <div class="ad-header">
                <h3 class="ad-title">感谢赞助人，服务得以存续</h3>
                <button class="ad-close" id="adCloseBtn">×</button>
            </div>
            <div class="ad-content">
                <img src="/assets/sponsor_placeholder.png" alt="赞助占位图" class="ad-img" onerror="this.src='https://via.placeholder.com/300x150'; this.alt='赞助广告';">
                <p class="ad-desc">感谢各位赞助人的支持，让这个工具能够持续维护和更新！</p>
                <div class="ad-countdown" id="adCountdown">倒计时：5秒后自动关闭</div>
            </div>
        </div>
    </div>

    <!-- 引入拆分的JS文件 -->
    <script src="/js/base.js"></script>
    <script src="/js/upload.js"></script>
    <script src="/js/ad-modal.js"></script>
    <script src="/js/progress.js"></script>
    <script src="/js/history.js"></script>
    <script src="/js/download.js"></script>
</body>
</html>